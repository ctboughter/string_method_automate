colvarstrajfrequency 20

colvar {
   name RMSD_PROA

   rmsd {
      atoms {
         atomsFile ./PROA2.pdb
	 atomsCol B
	 atomsColValue 1.0
      }
      refpositionsfile  ./PROA2.pdb
   }
} 

harmonic {         
   colvars          RMSD_PROA
   forceConstant    10.0
   centers           0.0
}                  

colvar {
   name RMSD_PROB

   rmsd {
      atoms {
         atomsFile ./PROB2.pdb
	 atomsCol B
	 atomsColValue 1.0
      }
      refpositionsfile  ./PROB2.pdb
   }
} 

harmonic {         
   colvars          RMSD_PROB
   forceConstant    10.0
   centers           0.0
}                  

colvar {
  name B302-SC1

  rmsd {
      atoms {
      	    # PROA and resid 85 87 88 89 92 93 94 96 236 238 243
      	    atomnumbers { 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811
	    812 813 814 831 832 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847
	    848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867
	    868 910 911 912 913 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928
	    929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948
	    949 950 951 976 977 978 979 980 981 982 983 984 985 3231 3232 3233 3234 3235 3236
	    3237 3238 3239 3240 3241 3242 3243 3244 3259 3260 3261 3262 3263 3264 3265 3266 3267
	    3268 3332 3333 3334 3335 3336 3337 3338 3339 3340 3341 3342 3343 3344 3345  }
	    }
	    refpositionsfile  ./proa-sc.pdb
	    refPositionsCol   B
	}
}

harmonic {
   colvars          B302-SC1
   forceConstant    10.0
   centers           0.0
}

colvar {
  name B302-SC2

  rmsd {
        atoms {
	      # PROB and resid 83 95 98 110 111 113 150 151 152 232
	        atomnumbers { 3796 3797 3798 3799 3800 3801 3802 3803 3804 3805 3806 3807 3808
		3809 3810 3811 3812 3813 3814 3990 3991 3992 3993 3994 3995 3996 3997 3998 3999
		4000 4001 4002 4003 4004 4005 4006 4007 4008 4009 4010 4011 4012 4013 4046 4047
		4048 4049 4050 4051 4052 4053 4054 4055 4056 4057 4058 4059 4060 4236 4237 4238
		4239 4240 4241 4242 4243 4244 4245 4246 4247 4248 4249 4250 4251 4252 4253 4254
		4255 4256 4257 4258 4259 4260 4261 4262 4263 4264 4265 4266 4267 4268 4269 4270
		4271 4272 4273 4291 4292 4293 4294 4295 4296 4297 4298 4299 4300 4301 4302 4303
		4304 4305 4306 4307 4308 4309 4310 4311 4885 4886 4887 4888 4889 4890 4891 4892
		4893 4894 4895 4896 4897 4898 4899 4900 4901 4902 4903 4904 4905 4906 4907 4908
		4909 4910 4911 4912 4913 4914 4915 4916 4917 4918 4919 4920 4921 4922 4923 4924
		4925 4926 4927 4928 4929 4930 4931 4932 4933 4934 4935 4936 4937 6202 6203 6204
		6205 6206 6207 6208 6209 6210 6211 6212 6213 6214 6215 6216 6217 6218 6219 6220  }
	      }
       refpositionsfile  ./prob-sc.pdb
       refPositionsCol   B
      }
}
											       
harmonic {
   colvars          B302-SC2
   forceConstant    10.0
   centers           0.0
}

# segname PROB and name C
# Dummy atom should be at COM of protein
# Probably could have put 0 0 0 but D.S. went real specific so I will too.
colvar {
   name Pin

   width 1.0

   distance {
        group1 {
	           dummyatom  (0, 0, 0)
	       }
	group2 {
	           atomnumbers { 3379 3396 3407 3417 3438 3452 3467 3491 3513 3535 3545 3564 3584 3606 3620 3630
		   3642 3658 3677 3696 3708 3722 3744 3758 3768 3780 3794 3813 3832 3851 3867 3878 3893 3905 3922
		   3946 3957 3973 3988 4012 4022 4044 4059 4073 4090 4102 4121 4135 4147 4161 4175 4190 4214 4234
		   4248 4272 4289 4310 4321 4337 4356 4363 4374 4389 4400 4420 4439 4450 4457 4481 4498 4519 4543
		   4558 4574 4589 4605 4612 4624 4648 4670 4685 4709 4726 4745 4752 4768 4779 4790 4812 4826 4842
		   4859 4883 4905 4912 4936 4952 4974 4991 5005 5019 5034 5048 5055 5075 5099 5113 5130 5137 5156
		   5170 5182 5189 5203 5225 5246 5270 5284 5303 5317 5332 5346 5370 5384 5398 5417 5439 5458 5472
		   5494 5508 5522 5544 5566 5582 5589 5605 5625 5644 5656 5677 5692 5706 5713 5725 5744 5755 5775
		   5796 5810 5820 5836 5848 5855 5866 5883 5902 5919 5933 5953 5972 5984 6000 6011 6031 6042 6057
		   6067 6086 6107 6121 6137 6157 6181 6200 6219 6233 6252 6267 6281 6295 6305 6324 6338 6357 6368
		   6382 6392 }
               }
	    }
}

harmonic {
   name             Pin
   colvars          Pin
   forceConstant    1.0
   centers          1.92868e+01
}

colvar {
   name Ang

   width 1.0
   lowerboundary  5
   upperboundary  90
   lowerwallconstant 100.0
   upperwallconstant 100.0
   angle {
           group1 {
	           dummyatom  (-40, -30, 0)
		  }
           group2 {
		   dummyatom  (0, 0, 0)
	          }
	   group3 {
	           atomnumbers { 3379 3396 3407 3417 3438 3452 3467 3491 3513 3535 3545 3564 3584 3606 3620 3630
		   3642 3658 3677 3696 3708 3722 3744 3758 3768 3780 3794 3813 3832 3851 3867 3878 3893 3905 3922
		   3946 3957 3973 3988 4012 4022 4044 4059 4073 4090 4102 4121 4135 4147 4161 4175 4190 4214 4234
		   4248 4272 4289 4310 4321 4337 4356 4363 4374 4389 4400 4420 4439 4450 4457 4481 4498 4519 4543
		   4558 4574 4589 4605 4612 4624 4648 4670 4685 4709 4726 4745 4752 4768 4779 4790 4812 4826 4842
		   4859 4883 4905 4912 4936 4952 4974 4991 5005 5019 5034 5048 5055 5075 5099 5113 5130 5137 5156
		   5170 5182 5189 5203 5225 5246 5270 5284 5303 5317 5332 5346 5370 5384 5398 5417 5439 5458 5472
		   5494 5508 5522 5544 5566 5582 5589 5605 5625 5644 5656 5677 5692 5706 5713 5725 5744 5755 5775
		   5796 5810 5820 5836 5848 5855 5866 5883 5902 5919 5933 5953 5972 5984 6000 6011 6031 6042 6057
		   6067 6086 6107 6121 6137 6157 6181 6200 6219 6233 6252 6267 6281 6295 6305 6324 6338 6357 6368
		   6382 6392}
	 	  }
	 }
}

harmonic {
   colvars          Ang
   forceConstant    0.0
   centers          0.0
}

colvar {
   name Ang2

   width 1.0
   lowerboundary 5
   upperboundary 80
   lowerwallconstant 100.0
   upperwallconstant 100.0

   angle {
          group1 {
	          dummyatom  (-40, 0, -30)
	         }
	  group2 {
	          dummyatom  (0, 0, 0)
	         }
	  group3 {
	          atomnumbers { 3379 3396 3407 3417 3438 3452 3467 3491 3513 3535 3545 3564 3584 3606 3620 3630
		  3642 3658 3677 3696 3708 3722 3744 3758 3768 3780 3794 3813 3832 3851 3867 3878 3893 3905 3922
		  3946 3957 3973 3988 4012 4022 4044 4059 4073 4090 4102 4121 4135 4147 4161 4175 4190 4214 4234
		  4248 4272 4289 4310 4321 4337 4356 4363 4374 4389 4400 4420 4439 4450 4457 4481 4498 4519 4543
		  4558 4574 4589 4605 4612 4624 4648 4670 4685 4709 4726 4745 4752 4768 4779 4790 4812 4826 4842
		  4859 4883 4905 4912 4936 4952 4974 4991 5005 5019 5034 5048 5055 5075 5099 5113 5130 5137 5156
		  5170 5182 5189 5203 5225 5246 5270 5284 5303 5317 5332 5346 5370 5384 5398 5417 5439 5458 5472
		  5494 5508 5522 5544 5566 5582 5589 5605 5625 5644 5656 5677 5692 5706 5713 5725 5744 5755 5775
		  5796 5810 5820 5836 5848 5855 5866 5883 5902 5919 5933 5953 5972 5984 6000 6011 6031 6042 6057
		  6067 6086 6107 6121 6137 6157 6181 6200 6219 6233 6252 6267 6281 6295 6305 6324 6338 6357 6368
		  6382 6392}
		 }
	 }
}

harmonic {
   colvars          Ang2
   forceConstant     0.0
   centers           0.0
}

colvar {
    name Theta
    scriptedFunction  eulerTheta 
    Orientation {
      atoms { 
         atomsFile ./PROA2.pdb
	 atomsCol B
	 atomsColValue 1.0
         centerReference    on
         rotateReference   on
	 enableFitGradients no
         refPositionsGroup {
             atomsFile ./PROB2.pdb
	     atomsCol B
	     atomsColValue 1.0
         }   
         refPositionsFile  ./PROB2.pdb
      }   
      refPositionsFile  ./PROA2.pdb
   }   
}

harmonic {
    name          Theta
    colvars       Theta
    forceconstant 0.1
    centers       3.56031e+02
}

colvar {
    name Phi
    scriptedFunction  eulerPhi
    Orientation {
      atoms { 
         atomsFile ./PROA2.pdb
	 atomsCol B
	 atomsColValue 1.0
         centerReference    on
         rotateReference   on
	 enableFitGradients no
         refPositionsGroup {
             atomsFile ./PROB2.pdb
	     atomsCol B
	     atomsColValue 1.0
         }   
         refPositionsFile  ./PROB2.pdb
      }   
      refPositionsFile  ./PROA2.pdb
   }   
}

harmonic {
    name          Phi
    colvars       Phi
    forceconstant 0.1
    centers       2.68075e+02
}

colvar {
    name Psi
    scriptedFunction  eulerPsi 
    Orientation {
      atoms { 
         atomsFile ./PROA2.pdb
	 atomsCol B
	 atomsColValue 1.0
         centerReference    on
         rotateReference   on
	 enableFitGradients no
         refPositionsGroup {
             atomsFile ./PROB2.pdb
	     atomsCol B
	     atomsColValue 1.0
         }   
         refPositionsFile  ./PROB2.pdb
      }   
      refPositionsFile  ./PROA2.pdb
   }   
}

harmonic {
    name          Psi
    colvars       Psi
    forceconstant 0.1
    centers       2.04350e+02
}

colvar {
    name polarTheta
    polarTheta {
      atoms { 
         atomsFile ./PROA2.pdb
	 atomsCol B
	  atomsColValue 1.0
         centerReference   on
         rotateReference   on
         refPositionsGroup {
             atomsFile ./PROB2.pdb
	     atomsCol B
	     atomsColValue 1.0
         }   
         refPositionsFile  ./PROB2.pdb
         }
	}
}

harmonic {
    name          polarTheta
    colvars       polarTheta
    forceconstant 0.1
    centers       8.59327e+01
}

colvar {
    name polarPhi
    polarPhi {
      atoms { 
         atomsFile ./PROA2.pdb
	 atomsCol B
	 atomsColValue 1.0
         centerReference   on
         rotateReference   on
         refPositionsGroup {
             atomsFile ./PROB2.pdb
	     atomsCol B
	     atomsColValue 1.0
         }   
         refPositionsFile  ./PROB2.pdb
         }
     }
}

harmonic {
    name          polarPhi
    colvars       polarPhi
    forceconstant 0.1
    centers       9.29031e+00
}

# Shit, this is leftover from Donghyuk's script...
colvar {
    name dist

    distance {
        group1 {
            atomnumbers {
                  23 42 61 76 91 110 134 158 182 193 212 229 250 260 271 295 302 317 341 358 369 379
		  400 414 429 453 475 497 507 526 546 568 582 592 604 620 639 658 670 684 706 720 730
		  742 756 775 794 813 829 840 855 867 884 908 919 935 950 974 984 1006 1021 1035 1052
		  1064 1083 1097 1109 1123 1137 1152 1176 1196 1210 1234 1251 1272 1283 1299 1318 1325
		  1336 1351 1362 1382 1401 1412 1419 1443 1460 1481 1505 1520 1536 1551 1567 1574 1586
		  1610 1632 1647 1671 1688 1707 1714 1730 1741 1752 1774 1788 1804 1821 1845 1867 1874
		  1898 1914 1936 1953 1967 1981 1996 2010 2017 2037 2061 2075 2092 2099 2118 2132 2144
		  2151 2165 2187 2208 2232 2246 2265 2279 2294 2308 2332 2346 2360 2379 2401 2420 2434
		  2456 2470 2484 2506 2528 2544 2551 2567 2587 2606 2618 2639 2654 2668 2675 2687 2706
		  2717 2737 2758 2772 2782 2798 2810 2817 2828 2845 2864 2881 2895 2915 2934 2946 2962
		  2973 2993 3004 3019 3029 3048 3069 3083 3099 3119 3143 3162 3181 3195 3214 3229 3243
		  3257 3267 3286 3300 3319 3330 3344 3354
            }
        }
        group2 {
            atomnumbers {
	    	  3379 3396 3407 3417 3438 3452 3467 3491 3513 3535 3545 3564 3584 3606 3620 3630 3642
		  3658 3677 3696 3708 3722 3744 3758 3768 3780 3794 3813 3832 3851 3867 3878 3893 3905
		  3922 3946 3957 3973 3988 4012 4022 4044 4059 4073 4090 4102 4121 4135 4147 4161 4175
		  4190 4214 4234 4248 4272 4289 4310 4321 4337 4356 4363 4374 4389 4400 4420 4439 4450
		  4457 4481 4498 4519 4543 4558 4574 4589 4605 4612 4624 4648 4670 4685 4709 4726 4745
		  4752 4768 4779 4790 4812 4826 4842 4859 4883 4905 4912 4936 4952 4974 4991 5005 5019
		  5034 5048 5055 5075 5099 5113 5130 5137 5156 5170 5182 5189 5203 5225 5246 5270 5284
		  5303 5317 5332 5346 5370 5384 5398 5417 5439 5458 5472 5494 5508 5522 5544 5566 5582
		  5589 5605 5625 5644 5656 5677 5692 5706 5713 5725 5744 5755 5775 5796 5810 5820 5836
		  5848 5855 5866 5883 5902 5919 5933 5953 5972 5984 6000 6011 6031 6042 6057 6067 6086
		  6107 6121 6137 6157 6181 6200 6219 6233 6252 6267 6281 6295 6305 6324 6338 6357 6368
		  6382 6392
	    }
        }
    }
}

harmonic {
    name          dist
    colvars       dist
    forceconstant 10.0
    centers       3.77542e+01
}

